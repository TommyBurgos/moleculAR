<!DOCTYPE html>
<html lang="en">
<head>
	{% load static %}
	<title>Eduport- LMS, Education and Course Theme</title>

			<!-- Hotjar - Seguimiento usuarios -->
	<script>
		(function(h,o,t,j,a,r){
			h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
			h._hjSettings={hjid:6485293,hjsv:6};
			a=o.getElementsByTagName('head')[0];
			r=o.createElement('script');r.async=1;
			r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
			a.appendChild(r);
		})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
	</script>

	<!-- Meta Tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="author" content="Webestica.com">
	<meta name="description" content="Eduport- LMS, Education and Course Theme">

	<!-- Dark mode -->
	<script>
		const storedTheme = localStorage.getItem('theme')
 
		const getPreferredTheme = () => {
			if (storedTheme) {
				return storedTheme
			}
			return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'light'
		}

		const setTheme = function (theme) {
			if (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches) {
				document.documentElement.setAttribute('data-bs-theme', 'dark')
			} else {
				document.documentElement.setAttribute('data-bs-theme', theme)
			}
		}

		setTheme(getPreferredTheme())

		window.addEventListener('DOMContentLoaded', () => {
		    var el = document.querySelector('.theme-icon-active');
			if(el != 'undefined' && el != null) {
				const showActiveTheme = theme => {
				const activeThemeIcon = document.querySelector('.theme-icon-active use')
				const btnToActive = document.querySelector(`[data-bs-theme-value="${theme}"]`)
				const svgOfActiveBtn = btnToActive.querySelector('.mode-switch use').getAttribute('href')

				document.querySelectorAll('[data-bs-theme-value]').forEach(element => {
					element.classList.remove('active')
				})

				btnToActive.classList.add('active')
				activeThemeIcon.setAttribute('href', svgOfActiveBtn)
			}

			window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
				if (storedTheme !== 'light' || storedTheme !== 'dark') {
					setTheme(getPreferredTheme())
				}
			})

			showActiveTheme(getPreferredTheme())

			document.querySelectorAll('[data-bs-theme-value]')
				.forEach(toggle => {
					toggle.addEventListener('click', () => {
						const theme = toggle.getAttribute('data-bs-theme-value')
						localStorage.setItem('theme', theme)
						setTheme(theme)
						showActiveTheme(theme)
					})
				})

			}
		})
		
	</script>

	<!-- Favicon -->
	<link rel="shortcut icon" href="assets/images/favicon.ico">

	<!-- Google Font -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap">

	<!-- Plugins CSS -->
	<link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/font-awesome/css/all.min.css' %} ">
	<link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %} ">
	<link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/apexcharts/css/apexcharts.css' %} ">
	<link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/overlay-scrollbar/css/overlayscrollbars.min.css' %} ">

	<!-- Theme CSS -->
	<link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}">

</head>

<body>


<!-- **************** MAIN CONTENT START **************** -->
<main>
	
<!-- Sidebar START -->
{% include 'usAdmin/baseSideBar.html' %}
<!-- Sidebar END -->

<!-- Page content START -->
<div class="page-content">

	<!-- Top bar START -->
	{% include 'usAdmin/navBar.html' %}
	<!-- Top bar END -->

	<!-- Page main content START -->
<div class="page-content-wrapper border">

  <!-- Title -->
  <div class="row">
    <div class="col-12">
      <h1 class="h3 mb-2 mb-sm-0">Students</h1>
    </div>
  </div>
      
  <div class="card bg-transparent">

    <!-- Card header START -->
    <div class="card-header bg-transparent border-bottom px-0">
      <!-- Search and select START -->
      <div class="row g-3 align-items-center justify-content-between">

        <!-- Search bar -->
        <div class="col-md-8">
          <form class="rounded position-relative">
            <input class="form-control bg-transparent" type="search" placeholder="Search" aria-label="Search" name="buscar" id="buscar" value="{{ buscar }}">

            <button class="bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset" type="submit">
              <i class="fas fa-search fs-6 "></i>
            </button>
          </form>

          <!-- Filtro -->
          <form method="get" class="mt-2">
            <div class="row g-2 align-items-center">
              <div class="col-auto">
                <label for="curso" class="col-form-label">Filtrar por curso:</label>
              </div>
              <div class="col-auto">
                <select id="curso" name="curso" class="form-select" onchange="this.form.submit()">
                  <option value="">-- Todos --</option>
                  {% for curso in cursos_docente %}
                    <option value="{{ curso.id }}" {% if curso_id == curso.id %}selected{% endif %}>
                      {{ curso.titulo }}
                    </option>
                  {% endfor %}
                </select>
              </div>
            </div>
          </form>
        </div>

        <!-- Tab button -->
        <div class="col-md-3">
          <ul class="list-inline mb-0 nav nav-pills nav-pill-dark-soft border-0 justify-content-end" id="pills-tab" role="tablist">
            <li class="nav-item">
              <a href="#nav-preview-tab-1" class="nav-link mb-0 me-2 active" data-bs-toggle="tab">
                <i class="fas fa-fw fa-th-large"></i>
              </a>
            </li>
            <li class="nav-item">
              <a href="#nav-html-tab-1" class="nav-link mb-0" data-bs-toggle="tab">
                <i class="fas fa-fw fa-list-ul"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <!-- Search and select END -->				 
    </div>
    <!-- Card header END -->

    <!-- Card body START -->
    <div class="card-body px-0">

      <!-- Tabs content START -->
      <div class="tab-content">

        <!-- Tabs content item START (Grid) -->
        <div class="tab-pane fade show active" id="nav-preview-tab-1">
          <div class="row g-4">
            {% for insc in inscripciones %}
              {% with user=insc.estudiante %}
              <!-- Card item START -->
              <div class="col-md-6 col-xxl-4">
                <div class="card bg-transparent border h-100"> 
                  <div class="card-header bg-transparent border-bottom d-flex justify-content-between">
                    <div class="d-sm-flex align-items-center">
                      <div class="avatar avatar-md flex-shrink-0">
                        <img class="avatar-img rounded-circle" src="{{ user.imgPerfil.url }}" alt="avatar">
                      </div>
                      <div class="ms-0 ms-sm-2 mt-2 mt-sm-0">
                        <h5 class="mb-0">
                          <a href="#">
                            {% if user.first_name or user.last_name %}
                              {{ user.first_name }} {{ user.last_name }}
                            {% else %}
                              {{ user.username|default:user.email }}
                            {% endif %}
                          </a>
                        </h5>
                        <span class="text-body small">
                          <i class="fas fa-fw fa-map-marker-alt me-1 mt-1"></i>{{ user.email }}
                        </span>
                      </div>
                    </div>
                  </div>

                  <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <div class="d-flex align-items-center">
                        <div class="icon-md bg-success bg-opacity-10 text-success rounded-circle flex-shrink-0"><i class="bi bi-check-circle"></i></div>
                        <h6 class="mb-0 ms-2 fw-light">Estado:</h6>
                      </div>
                      <span class="mb-0 fw-bold">
                        {% if user.is_active %}Activo{% else %}Inactivo{% endif %}
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <div class="d-flex align-items-center">
                        <div class="icon-md bg-purple bg-opacity-10 text-purple rounded-circle flex-shrink-0"><i class="fas fa-book fa-fw"></i></div>
                        <h6 class="mb-0 ms-2 fw-light">Rol:</h6>
                      </div>
                      <span class="mb-0 fw-bold">{{ user.rol }}</span>
                    </div>

                    <div class="overflow-hidden">
                      <h6 class="mb-0">Progreso (demo)</h6>
                      <div class="progress progress-sm bg-primary bg-opacity-10">
                        <div class="progress-bar bg-primary" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="badge bg-success mt-2"><i class="bi bi-trophy-fill me-1"></i>Completado</span>
                    </div>
                  </div>

                  <div class="card-footer bg-transparent border-top">
                    <div class="d-sm-flex justify-content-between align-items-center">
                      <h6 class="mb-2 mb-sm-0">
                        <i class="bi bi-calendar fa-fw text-orange me-2"></i>
                        <span class="text-body">Último login:</span> {{ user.last_login }}
                      </h6>
                    </div>
                  </div>
                </div>
              </div>
              {% endwith %}
            {% empty %}
              <p class="text-muted">No hay estudiantes inscritos aún en tus cursos.</p>
            {% endfor %}
          </div>
        </div>
        <!-- Tabs content item END -->

        <!-- Tabs content item START (Table) -->
        <div class="tab-pane fade" id="nav-html-tab-1">
          <div class="table-responsive border-0">
            <table class="table table-dark-gray align-middle p-4 mb-0 table-hover">
              <thead>
                <tr>
                  <th>Nombre usuario</th>
                  <th>Último acceso</th>
                  <th>Estado</th>
                  <th>Rol</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                {% for insc in inscripciones %}
                  {% with user=insc.estudiante %}
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar avatar-md">
                          <img src="{{ user.imgPerfil.url }}" class="rounded-circle" alt="">
                        </div>
                        <div class="mb-0 ms-3">
                          <h6 class="mb-0">
                            <a href="#">
                              {% if user.first_name or user.last_name %}
                                {{ user.first_name }} {{ user.last_name }}
                              {% else %}
                                {{ user.username|default:user.email }}
                              {% endif %}
                            </a>
                          </h6>
                          <span class="text-body small"><i class="fas fa-fw fa-envelope me-1"></i>{{ user.email }}</span>
                        </div>
                      </div>
                    </td>
                    <td>{{ user.last_login }}</td>
                    <td>{% if user.is_active %}Activo{% else %}Inactivo{% endif %}</td>
                    <td>{{ user.rol }}</td>
                    <td>
                      <a href="#" class="btn btn-light btn-round me-1"><i class="bi bi-eye"></i></a>
                      <a href="#" class="btn btn-light btn-round me-1"><i class="bi bi-envelope"></i></a>
                      <button class="btn btn-light btn-round"><i class="fas fa-ban"></i></button>
                    </td>
                  </tr>
                  {% endwith %}
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        <!-- Tabs content item END -->

      </div>
      <!-- Tabs content END -->
    </div>
    <!-- Card body END -->

    <!-- Card footer START -->
			<div class="card-footer bg-transparent pt-0 px-0">
				<!-- Pagination START -->
				<!-- Pagination START -->
				<div class="mt-4 d-flex justify-content-center">
					<nav>
						<ul class="pagination">
							{% if inscripciones.has_previous %}
                            <a class="page-link" href="?page={{ num }}{% if curso_id %}&curso={{ curso_id }}{% endif %}{% if buscar %}&buscar={{ buscar }}{% endif %}">
                                {{ num }}
                            </a>

                            {% endif %}

                            {% for num in inscripciones.paginator.page_range %}
                            {% if inscripciones.number == num %}
                                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                            {% else %}
                                <li class="page-item"><a class="page-link" href="?page={{ num }}{% if curso_id %}&curso={{ curso_id }}{% endif %}">{{ num }}</a></li>
                            {% endif %}
                            {% endfor %}

                            {% if inscripciones.has_next %}
                            <a class="page-link" href="?page={{ num }}{% if curso_id %}&curso={{ curso_id }}{% endif %}{% if buscar %}&buscar={{ buscar }}{% endif %}">
                            {{ num }}
                            </a>

                            {% endif %}

						</ul>
					</nav>
				</div>
				<!-- Pagination END -->

				<!-- Pagination END -->
			</div>
			<!-- Card footer END -->

  </div>
</div>
<!-- Page main content END -->


</div>
<!-- Page content END -->

</main>
<!-- **************** MAIN CONTENT END **************** -->

<!-- Back to top -->
<div class="back-top"><i class="bi bi-arrow-up-short position-absolute top-50 start-50 translate-middle"></i></div>

<!-- Bootstrap JS -->
<script src="{% static 'assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>

<!-- Vendors -->
<script src="{% static 'assets/vendor/aos/aos.js' %}"></script>
<script src="{% static 'assets/vendor/overlay-scrollbar/js/overlayscrollbars.min.js' %}"></script>

<!-- Template Functions -->
<script src="{% static 'assets/js/functions.js' %}"></script>

</body>
</html>
